library ("dbscan")
matrix <- read.table(file="PCLA_564588_dist_matrix.txt",header=TRUE,sep="\t")
dist_matrix <- as.dist(matrix)
knndist <- dbscan::kNNdist(dist_matrix, 6, bucketSize=1, splitRule="SUGGEST")
write.table(knndist, file="PCLA_564588_knn_table.txt", sep="\t", row.names=TRUE)
pdf(file="PCLA_564588_knn_dist_plot.pdf")
dbscan::kNNdistplot(dist_matrix, 6, bucketSize=1, splitRule="SUGGEST")
abline(h=1.08128, col="red")
title(main="Epsilon=1.08128")
dev.off()
detach("package:dbscan", unload=TRUE)
library ("fpc")
pdf(file="PCLA_564588_dbscan_plot.pdf")
dbscan_clus <- fpc::dbscan(dist_matrix, 1.08128, MinPts=6, method="dist", showplot=1)
dev.off()
write.table(dbscan_clus$cluster, file="PCLA_564588_dbscan_clusters.txt",sep="\t", row.names=TRUE)
